(function(e,t,n,r){"use strict";e.fn.formValidation=function(n){var i={username:"#full_name",validationMessage:"validationMessage",requireClass:"required",emailClass:"email",passClass:"pass",passConfirmClass:"pass_confirm",errorClass:"alert error",errorBoxClass:"val-box",otherMessages:".status-messages",statusMessagesClass:"js-status-message",emailRegEx:/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/,passRegEx:/^.*(?=.{8,})(?=.*[0-9])[a-zA-Z0-9]+$/,showErrorMsg:true,consecutiveErrors:true,appendErrorToTitle:true,saveInputs:true,ajaxMode:true,formSuccessMsgID:"#success_message",defaultErrorMsg:"Please enter a value",defaultSuccessMsg:"You have successfully submitted the form",dataURL:"",successFunction:null};var s=e.extend({},i,n);e.fn.fn_error=function(t){var n={on:function(){this.each(function(){e(this).addClass(s.errorClass)});setTimeout(function(){},1e3);return this},off:function(){this.each(function(){e(this).removeClass(s.errorClass)});return this},clear:function(){this.each(function(){localStorage.removeItem(e(this).attr("name"))});return this}};if(n[t]){return n[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.on.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.fn_error")}};e.fn.fn_center=function(n,r){var i=r!=null?e(r):e(t);var s={all:function(){i.css("position","relative");this.css("position","absolute");this.css("top",(i.height()-this.outerHeight())/2+i.scrollTop()+"px");this.css("left",(i.width()-this.outerWidth())/2+i.scrollLeft()+"px");return this},vertical:function(){i.css("position","relative");this.css("position","absolute");this.css("top",(i.height()-this.outerHeight())/2+i.scrollTop()+"px");return this},horizontal:function(){i.css("position","relative");this.css("position","absolute");this.css("left",(i.width()-this.outerWidth())/2+i.scrollLeft()+"px");return this}};if(s[n]){return s[n].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof n==="object"||!n){return s.all.apply(this,arguments)}else{e.error("Method "+n+" does not exist on jQuery.center")}};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e,t){if(t==null){t=0}else if(t<0){t=Math.max(0,this.length+t)}for(var n=t,r=this.length;n<r;n++){if(this[n]===e)return n}return-1}}var o={loadingAnimation:function(t,n,r){e.getScript("http://heartcode-canvasloader.googlecode.com/files/heartcode-canvasloader-min-0.9.js",function(){var e=new CanvasLoader(t);e.setShape("spiral");e.setDiameter(n);e.setDensity(13);e.setRange(.6);e.setSpeed(1);e.setColor(r);e.show()})}};return this.each(function(){var t=e(this);var n={init:function(){t.attr("novalidate","novalidate");e(s.otherMessages).hide();this.error_numeric="Must be a number";this.form_action=s.dataURL?s.dataURL:t.attr("action");this.cacheElements();this.createElements()},cacheElements:function(){this.status_messages=e('<div class="'+s.statusMessagesClass+'"></div>');this.errorBox=e('<span class="'+s.errorBoxClass+'"></span>')},createElements:function(){t.before(this.status_messages)},initForm:function(){this.validated=true;this.enquiryname=e(s.username,t).val();try{this.successMsg=e(s.formSuccessMsgID,t).val().replace("[name]",this.enquiryname)}catch(n){this.successMsg=s.defaultSuccessMsg}this.errorBox.empty().remove();e("."+s.errorBoxClass).empty().remove();this.errorArray=[]},getLocalStorage:function(){e("input, select, textarea",t).each(function(){var t=e(this).attr("name");if(localStorage[t]){if(e(this).is("select")){e('option[selected="selected"]',this).removeAttr("selected");e('option[value="'+localStorage[t]+'"]',this).prop("selected",true)}else if(e(this).is('input[type="radio"]')){if(e(this).val()==localStorage[t])e(this).prop("checked",true)}else if(e(this).is('input[type="checkbox"]')){var n=localStorage[t].split(",");e('input[name="'+t+'"]').each(function(t){if(n[t]!=""&&e(this).val()==n[t])e(this).prop("checked",true)})}else{e(this).val(localStorage[t])}}})},resetForm:function(){e("."+s.errorBoxClass,t).remove();e('option[selected="selected"]',t).removeAttr("selected");e("input, select, textarea, label",t).removeClass(s.errorClass).fn_error("clear").removeAttr("selected")},addToError:function(e){e.fn_error("on");var t=e.attr("id");if(this.errorArray.indexOf(t)==-1){this.errorArray.push(t)}},displayErrors:function(){if(this.errorArray.length>0){n.validated=false;e.each(this.errorArray,function(r){var i=e("#"+n.errorArray[r],t);if(i.is('input[type="checkbox"]')||i.is('input[type="radio"]')){var o=i.parent().parent().find(".label");var u=i.parent().parent().find("."+s.validationMessage);var a=u.length?u.val():s.defaultErrorMsg}else{var o=i.parent().find("label");var u=i.parent().find("."+s.validationMessage);var a=u.length?u.val():s.defaultErrorMsg}if(s.showErrorMsg){if(s.consecutiveErrors){if(!r){n.errorBox.text(a);if(s.appendErrorToTitle){n.errorBox.prepend(" - ");o.append(n.errorBox)}else{i.parent().prepend(n.errorBox)}n.errorBox.fadeIn(500);i.focus()}}else{if(s.appendErrorToTitle){o.append('<span class="'+s.errorBoxClass+'"></span>');if(u.is("input")){e("."+s.errorBoxClass).text(" - "+u.val())}else{e("."+s.errorBoxClass).text(" - "+u.text())}}else{i.parent().prepend('<span class="'+s.errorBoxClass+'"></span>');if(u.is("input")){e("."+s.errorBoxClass).text(u.val())}else{e("."+s.errorBoxClass).text(u.text())}}e("."+s.errorBoxClass).fadeIn(500)}}})}},checkhttp:function(e){var t=e.val();if(t!=""&&t.indexOf("http://")==-1){e.val("http://"+t)}},formValidated:function(){e("button",t).attr("disabled","disabled");var r=Math.random()*(100-1)+1;n.buttonName=e('button[type="submit"]',t).text();e('button[type="submit"]',t).html('<div id="loader-'+r+'"></div>');e("#loader").fn_center("all");o.loadingAnimation("loader-"+r,13,"#333");this.status_messages.hide();this.errorBox.remove()}};n.init();if(s.saveInputs&&typeof Storage!=="undefined"){n.getLocalStorage();e("input, select, textarea",t).change(function(){var t=e(this).attr("name");if(e(this).is('input[type="checkbox"]')){var n=[];e('input[name="'+t+'"]').each(function(r){if(e(this).is(":checked")){n.push(e(this).val())}else if(e(this).is("select")){localStorage[t]=e("option:selected",this).val()}else{n.push("")}});localStorage[t]=n}else{localStorage[t]=e(this).val()}})}e(function(){if(e(".status_messages").length){e(".status_messages").hide()}e(s.requireClass,t).each(function(){e(this).parent().find("label, .label").addClass("required")});e('input[type="url"]',this).each(function(){e(this).on("blur",function(){n.checkhttp(e(this))})});e('button[type="reset"], input[type="reset"]',t).on("click",function(){n.resetForm()})});t.on("submit",function(){n.initForm();var i=[];e("."+s.requireClass+",."+s.emailClass+",."+s.passClass+",."+s.passConfirmClass,this).each(function(){if(e(this).hasClass(s.requireClass)&&e(this).val().length==0||e(this).val()==r){n.addToError(e(this))}else if(e(this).hasClass(s.emailClass)&&!s.emailRegEx.test(e(this).val())){n.addToError(e(this))}else if(e(this).hasClass(s.passClass)&&!s.regPass.test(e(this).val())){n.addToError(e(this))}else if(e(this).hasClass(s.passConfirmClass)&&e(this).val()!==e("input."+s.passClass).val()){n.addToError(e(this))}else if(e(this).hasClass(s.requireClass)&&e(this).is('input[type="radio"]')||e(this).is('input[type="checkbox"]')){var t=e(this).attr("name");var i=e('input[name="'+t+'"]');if(i.serializeArray().length==0){e(this).fn_error("on").parent().parent().find(".label, label").fn_error("on");var o=i.attr("id");if(n.errorArray.indexOf(o)==-1){n.errorArray.push(o)}}else{e(this).fn_error("off").parent().parent().find(".label, label").fn_error("off")}}else{e(this).fn_error("off")}});n.displayErrors();if(n.validated){n.formValidated();if(s.ajaxMode){if(e.isFunction(s.successFunction)){s.successFunction()}else{e.ajax({type:"POST",url:n.form_action,data:t.serialize(),success:function(){t.hide();n.status_messages.html("<p>"+n.successMsg+"</p>").fadeIn(500);e("input, textarea, select",t).fn_error("clear")},error:function(r,i,s){alert("Failure");e("button",t).removeAttr("disabled");e('button[type="submit"]',t).html(n.buttonName)}})}}else{e("input, textarea, select",t).fn_error("clear");return true}}return false})})};e(function(){e('.email, input[type="email"]').each(function(){var t=e('<div class="suggestion">Did you mean <a href="#" class="alternate_email"><span class="toplevel">something</span>@<span class="dom">yourdomain.com</span></a>?</div>');e(this).after(t.hide())});if(s!==r&&s.emailsuggest!==r){if(s.emailsuggest.init!==r){s.emailsuggest.init()}if(s.emailsuggest.query!==r&&s.emailsuggest.query.init!==r){s.emailsuggest.query.init()}}});var i={};var s={Models:{},Collections:{}};i.validators={emailDomainSuggester:function(e){var t=new Array("aol.com","bellsouth.net","btinternet.com","btopenworld.com","blueyonder.co.uk","comcast.net","cox.net","gmail.com","google.com","googlemail.com","hotmail.co.uk","hotmail.com","hotmail.fr","hotmail.it","icloud.com","live.com","mac.com","mail.com","me.com","msn.com","o2.co.uk","orange.co.uk","outlook.com","outlook.co.uk","sbcglobal.net","verizon.net","virginmedia.com","yahoo.com","yahoo.co.uk","yahoo.com.tw","yahoo.es","yahoo.fr");var n=e.split("@");var r;var i=99;var s=null;for(var o=0;o<t.length;o++){r=this.stringDistance(t[o],n[1]);if(r<i){i=r;s=t[o]}}if(i<=2&&s!==null&&s!==n[1]){return{address:n[0],domain:s}}else{return false}},stringDistance:function(e,t){if(e==null||e.length===0){if(t==null||t.length===0){return 0}else{return t.length}}if(t==null||t.length===0){return e.length}var n=0;var r=0;var i=0;var s=0;var o=5;while(n+r<e.length&&n+i<t.length){if(e[n+r]==t[n+i]){s++}else{r=0;i=0;for(var u=0;u<o;u++){if(n+u<e.length&&e[n+u]==t[n]){r=u;break}if(n+u<t.length&&e[n]==t[n+u]){i=u;break}}}n++}return(e.length+t.length)/2-s}};s.emailsuggest={query:{init:function(){this.suggestedEmail=null;e('.email, input[type="email"]').on("blur",this.suggestEmail);e(".suggestion .alternate_email").on("click",this.fillInSuggestedEmail)},suggestEmail:function(t){var n=e(this).val();var r=i.validators.emailDomainSuggester(n);var o=e(this).parent().find(".suggestion");var u=e(".toplevel",o);var a=e(".dom",o);if(r){u.html(r.address);a.html(r.domain);s.emailsuggest.query.suggestedEmail=r;o.slideDown(500)}else{s.emailsuggest.query.suggestedEmail=null;o.slideUp(500)}},fillInSuggestedEmail:function(t,n){t.preventDefault();var r=s.emailsuggest.query.suggestedEmail;if(r){e(this).parent().parent().find(".email").val(r.address+"@"+r.domain);e(this).parent(".suggestion").slideUp(500)}}}}})(jQuery,window,document)
